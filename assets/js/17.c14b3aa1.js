(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{458:function(t,e,r){"use strict";r.r(e);var n=r(44),i=r(419),s=r(93),a=r(314),u=r(58),o=(r(103),r(72),r(28),r(68),r(320),r(420),r(94),r(421),r(180),r(181),r(422),r(182),r(176),r(423)),c=r.n(o),p=r(318),d=r(328),l=r(326),f={name:"DruxtView",extends:p.d,props:{displayId:{type:String,default:"default"},type:{type:String,default:"view--view"},uuid:{type:String,required:!0},viewId:{type:String,required:!0}},fetch:function(){var t=this;return Object(u.a)(regeneratorRuntime.mark((function e(){var r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(a.a)({},t.component),t.view){e.next=7;break}return e.next=4,t.getResource({type:t.type,id:t.uuid});case 4:t.view=e.sent,n=t.getModuleComponents(),r={is:((n.filter((function(t){return t.global}))||[])[0]||{}).name||"DruxtWrapper",options:n.map((function(t){return t.name}))||[]};case 7:return e.next=9,t.getWrapperData(r.is);case 9:return i=e.sent,r.settings=c()((t.$druxtViews||{}).options||{},i.druxt||{},{arrayMerge:function(t,e){return e}}),s=t.getQuery(r.settings),e.next=14,t.getResults({viewId:t.viewId,displayId:t.displayId,query:Object(d.stringify)(s)});case 14:t.resource=e.sent,r=Object(a.a)(Object(a.a)({},r),t.getModulePropsData(i.props)),t.component=r;case 17:case"end":return e.stop()}}),e)})))()},data:function(){var t=Object(d.parse)(Object(d.stringify)(this.$route.query));return{model:{filter:t.filter||{},page:parseInt(t.page)||null,sort:t.sort||null},resource:null,view:!1}},computed:{attachments_after:function(){var t=this;if(!(((this.view||{}).data||{}).attributes||{}).display)return!1;var e=this.view.data.attributes.display;return Object.keys(e).filter((function(r){return"attachment"===e[r].display_plugin&&"after"===e[r].display_options.attachment_position&&void 0!==e[r].display_options.displays[t.displayId]}))},attachments_before:function(){var t=this;if(!(((this.view||{}).data||{}).attributes||{}).display)return!1;var e=this.view.data.attributes.display;return Object.keys(e).filter((function(r){return"attachment"===e[r].display_plugin&&"before"===e[r].display_options.attachment_position&&void 0!==e[r].display_options.displays[t.displayId]}))},count:function(){return parseInt(((this.resource||{}).meta||{}).count)||0},display:function(){return!!(((this.view||{}).data||{}).attributes||{}).display&&("default"===this.display_id?this.view.data.attributes.display[this.display_id]:c()(this.view.data.attributes.display.default,this.view.data.attributes.display[this.displayId]))},filters:function(){return Object.values(((this.display||{}).display_options||{}).filters||{}).filter((function(t){return t.exposed}))},headers:function(){return this.display?this.display.display_options.header:[]},mode:function(){return this.display&&this.display.display_options.row.type.includes("entity:")&&(this.display.display_options.row.options||{}).view_mode||"default"},pager:function(){return((this.display||{}).display_options||{}).pager||!1},results:function(){return(this.resource||{}).data||[]},showPager:function(){return this.pager.type&&"none"!==this.pager.type},showSorts:function(){return!(!((((this.display||{}).display_options||{}).exposed_form||{}).options||{}).expose_sort_order||!this.sorts.length)},sorts:function(){return Object.values(((this.display||{}).display_options||{}).sorts||{}).filter((function(t){return t.exposed}))}},watch:{"$route.query":function(t,e){var r=this;return Object(u.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object.entries(t).length||(r.model={filter:null,page:null,sort:null});case 1:case"end":return e.stop()}}),e)})))()},displayId:function(){var t=this;return Object(u.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch();case 2:case"end":return e.stop()}}),e)})))()},query:function(t,e){var r=this;return Object(u.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$fetch();case 2:case"end":return t.stop()}}),t)})))()},uuid:function(){var t=this;return Object(u.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch();case 2:case"end":return e.stop()}}),e)})))()},model:{deep:!0,handler:function(){var t=this;return Object(u.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch();case 2:case"end":return e.stop()}}),e)})))()}}},methods:Object(a.a)({getScopedSlots:function(){var t=this,e={header:function(){return Object.entries(t.headers).map((function(e){var r=Object(s.a)(e,2),n=r[0],i=r[1];return t.$createElement("span",{domProps:{innerHTML:(i.content||{}).value},key:n})}))}};return this.filters.length&&(e.filters=function(e){return t.$createElement("DruxtViewsFilters",{attrs:Object(a.a)({},e),on:{input:function(e){t.model.filter=e}},props:Object(a.a)({filters:t.filters,value:t.model.filter},t.display.display_options.exposed_form)})}),this.showSorts&&(e.sorts=function(e){return t.$createElement("DruxtViewsSorts",{attrs:Object(a.a)({},e),on:{input:function(e){t.model.sort=e}},props:Object(a.a)({sorts:t.sorts,value:t.model.sort},t.display.display_options.exposed_form)})}),this.attachments_before&&(e.attachments_before=function(e){return t.attachments_before.map((function(r){return t.$createElement("DruxtView",{attrs:Object(a.a)({},e),key:r,props:{displayId:r,type:t.type,uuid:t.uuid,viewId:t.viewId}})}))}),e.results=function(e){return t.results.map((function(r){return t.$createElement("DruxtEntity",{attrs:Object(a.a)({},e),key:r.id,props:{mode:t.mode,type:r.type,uuid:r.id}})}))},this.showPager&&(e.pager=function(e){return t.$createElement("DruxtViewsPager",{attrs:Object(a.a)({},e),on:{input:function(e){t.model.page=e}},props:Object(a.a)({count:t.count,resource:t.resource,value:t.model.page},t.pager)})}),this.attachments_after&&(e.attachments_after=function(e){return t.attachments_after.map((function(r){return t.$createElement("DruxtView",{attrs:Object(a.a)({},e),key:r,props:{displayId:r,type:t.type,uuid:t.uuid,viewId:t.viewId}})}))}),e.default=function(t){return Object.keys(e).filter((function(t){return!["default","_normalized"].includes(t)})).map((function(r){return e[r](t)}))},e},getQuery:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},r=(t.query||{}).resourceTypes||[];if(!0===(t.query||{}).bundleFilter){var s=((this.display||{}).display_options||{}).filters||[];Object.values(s).map((function(t){"bundle"===t.plugin_id&&t.value&&Object.keys(t.value).map((function(e){r.push("".concat(t.entity_type,"--").concat(e))}))}))}if((r||[]).length){var a,u=Object(i.a)(r);try{for(u.s();!(a=u.n()).done;){var o=a.value;e["fields[".concat(o,"]")]=["uuid"].concat(Object(n.a)((t.query||{}).fields||[])).join(",")}}catch(t){u.e(t)}finally{u.f()}}return this.model.page&&(e.page=this.model.page),Object.entries(this.model.filter||{}).length&&(e["views-filter"]=this.model.filter),this.model.sort&&(e["views-sort[sort_by]"]=this.model.sort),e},onFiltersUpdate:function(){this.model.page=null,this.model.sort=null}},Object(l.a)({getResource:"druxt/getResource",getResults:"druxt/views/getResults"})),druxt:{componentOptions:function(t){return[[t.viewId,t.displayId]]},propsData:function(t){return{count:t.count,display:t.display,mode:t.mode,pager:t.pager,results:t.results,view:t.view}}}},y=r(46),h=Object(y.a)(f,void 0,void 0,!1,null,null,null);e.default=h.exports}}]);